$.Class("GraphImage",{},{init:function(e){this.NodeViz=e;$.extend(this,e.options.image);$("#tooltip").length||$(document.body).prepend($("<div/>").attr("id","tooltip"));this.tooltip=$("#tooltip");$("#"+this.graphdiv).html("<div id='images'></div><div id='imagescreen' style='display:none;'></div>");this.graphDimensions=this.getDimensions();$("#imagescreen").clonePosition($("#"+this.graphdiv));typeof this.tooltipOffsetY=="undefined"&&(this.tooltipOffsetY=-5);typeof this.tooltipOffsetX=="undefined"&&(this.tooltipOffsetX=5)},reset:function(){$("#image").unbind();this.graphDimensions=this.getDimensions()},render:function(e){},appendOptions:function(){this.NodeViz.appendParam("useSVG",this.NodeViz.options.useSVG);this.NodeViz.appendParam("graphWidth",this.graphDimensions.width);this.NodeViz.appendParam("graphHeight",this.graphDimensions.height)},setOffsets:function(){if($("#image")){this.offsetX=$("#image").offset().left||0;this.offsetY=$("#image").offset().top}$("#imagescreen").css({top:$("#"+this.graphdiv).offset().top,left:$("#"+this.graphdiv).offset().left})},mousemove:function(e){if(this.tooltip.css("visibility")=="visible"||this.tooltip.css("left")=="0px"){var t={x:e.pageX,y:e.pageY};this.moveTooltip(t)}},setupListeners:function(){$("#image").mousemove($.proxy(this.mousemove,this));this.tooltip.mousemove($.proxy(this.mousemove,this));this.tooltip.mouseout($.proxy(this.hideTooltip,this));this.tooltip.click($.proxy(function(e){var t=$("#"+this.current.node);e.currentTarget=t;e.delegateTarget=t;t.trigger(e)},this.NodeViz))},resize:function(){this.graphDimensions=this.getDimensions();this.setOffsets()},moveTooltip:function(e){this.tooltip.html()==""&&this.tooltip.html("1");typeof this.offsetX=="undefined"&&this.setOffsets();var t=e.x+this.tooltipOffsetX,n=e.y+this.tooltipOffsetY-this.tooltip.outerHeight();this.center_tooltip&&(t-=this.tooltip.outerWidth()/2);this.tooltip.css({top:n+"px",left:t+"px"})},showTooltip:function(e){if(typeof this.state!="undefined"&&this.state!=="")return;if(e!=""&&this.tooltip.position().left){this.setTooltip(e);this.tooltip.css({visibility:"visible"})}},setTooltip:function(e){this.tooltip.html(e)},hideTooltip:function(){this.tooltip.css("visibility","hidden");$("#images").css("cursor","default")},highlightNode:function(e,t,n){typeof this.offsetY=="undefined"&&this.setOffsets();if(!t){e=e.toString();this.showTooltip(this.NodeViz.data.nodes[e].tooltip);if(n=="list")if(this.NodeViz.options.useSVG==1){var r=$("#"+e).children("polygon, ellipse")[0],i=r.getBoundingClientRect(),s={x:i.right,y:i.top};this.center_tooltip&&(s.x-=i.width/2);this.moveTooltip(s)}else{var r=$("#"+e),o=r.attr("coords").split(","),u=$("#image").offset();this.moveTooltip({x:parseInt(o[2])+u.left,y:parseInt(o[1])})}}},unhighlightNode:function(e){this.hideTooltip()},selectNode:function(e){},unselectNode:function(e){},getDimensions:function(){return{height:$("#"+this.graphdiv).height(),width:$("#"+this.graphdiv).width()}}});